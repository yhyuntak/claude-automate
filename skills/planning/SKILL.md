---
name: planning
description: Brain 기반 구현 계획 수립. "planning", "계획", "어떻게 구현", "설계" 키워드로 자동 활성화
argument-hint: "[feature description]"
---

# /planning

> Brain의 패턴과 예시를 참고하여 구현 계획 수립

$ARGUMENTS

---

## 목적

**brainstorm vs planning 구분:**

| 단계 | 목적 | Brain 필요 |
|------|------|-----------|
| brainstorm | **뭘** 만들지 구체화 | ❌ |
| planning | **어떻게** 만들지 계획 | ✅ |

---

## 플로우 개요

```
[사용자 요청]
      │
      ▼
┌─────────────────────┐
│ 요구사항 충분한가?  │
└─────────────────────┘
      │
      ├─ No ──→ [Brainstorm 호출]
      │              │
      │              ▼
      │         [angel 😇] ← 생각 확장
      │              │
      │              ▼
      │         [요구사항 정리]
      │              │
      ▼              │
     Yes ←───────────┘
      │
      ▼
┌─────────────────────┐
│ devil 😈            │ ← 현실성 검증
└─────────────────────┘
      │
      ▼
┌─────────────────────┐
│ 코드베이스 탐색     │
└─────────────────────┘
      │
      ▼
┌─────────────────────┐
│ 시각화 필요한가?    │──→ Yes ──→ [ASCII 시각화 제안]
└─────────────────────┘
      │
      ▼
┌─────────────────────┐
│ Plan Mode 진입      │
└─────────────────────┘
      │
      ▼
┌─────────────────────┐
│ devil 😈            │ ← 계획 최종 검증
└─────────────────────┘
```

---

## 실행 프로토콜

### Phase 0: 요구사항 충분도 판단

계획 수립 전, 요구사항이 충분한지 확인:

**통과 기준**: 최소 3개 명확해야 함

- [ ] **Context 또는 Why** - 왜 이 기능이 필요한가?
- [ ] **What (핵심 기능)** - 무엇을 구현하는가?
- [ ] **Success Criteria 또는 Scope** - 어떻게 검증하는가? 어디까지 포함하는가?

**판단 방법**:
1. 사용자 요청에서 위 3가지 체크리스트 평가
2. 2개 이하만 명확하면 **요구사항 부족**으로 판단

**요구사항 부족 시**:
```
"요구사항이 충분하지 않습니다. 더 구체화하기 위해 brainstorm 스킬을 사용하시겠습니까?"

brainstorm 스킬에서 angel 😇이 생각을 확장해드립니다.
```

AskUserQuestion으로 brainstorm 호출 제안.

**요구사항 충분 시**: Phase 0.5로 이동

### Phase 0.5: devil 현실성 검증

요구사항 확정 직후, devil 😈 페르소나로 현실성 검증:

**검증 항목**:
- 기술적 실현 가능성
- 리소스 (시간, 인력) 현실성
- 의존성 복잡도
- 잠재적 리스크

**출력 형식**:
```markdown
## devil 😈 현실성 검증

### 경고 사항
- {우려 1}
- {우려 2}

### 제안
- {대안 또는 완화책}
```

검증 후 Phase 1로 이동.

### Phase 1: 코드베이스 탐색

무엇을 수정/생성할지 파악:

```
- 기존 관련 코드 위치 확인
- 의존성 파악
- 영향 범위 추정
```

### Phase 2: 구현 틀 식별

필요한 구현 유형 파악:

```
예시:
- "새 에이전트 필요" → agent-design 패턴
- "새 커맨드 필요" → command-structure 패턴
- "새 스킬 필요" → skill-structure 패턴
- "API 엔드포인트 필요" → api-design 패턴
```

### Phase 3: Brain 참조

1. `.claude/brain.md` 존재 여부 확인

2. **Brain이 있으면:**
   - 패턴 인덱스 읽기
   - 구현 틀에 맞는 패턴 링크 식별
   - 해당 상세 파일 읽기 (`.claude/brain/patterns/*.md`)
   - 예시 기반 설계

3. **Brain이 없으면:**
   - ⚠️ 경고 표시: "이 프로젝트에 brain.md가 없습니다. 코드베이스 탐색 결과만으로 계획을 수립합니다."
   - 코드베이스 탐색 결과만으로 계획 수립
   - 계획 출력에 "참고한 패턴: 없음 (brain 미설정)" 표시

```bash
# Brain 존재 확인
ls .claude/brain.md

# Brain이 있으면 인덱스 확인
cat .claude/brain.md

# 필요한 패턴 상세 읽기
cat .claude/brain/patterns/{relevant-pattern}.md
```

### Phase 3.5: ASCII 시각화 제안

계획 수립 전, 시각화가 필요한지 판단:

**시각화 제안 조건** (하나라도 해당 시):
- UI 레이아웃을 설명해야 할 때
- 데이터 플로우를 설명해야 할 때
- 아키텍처 구조를 설명해야 할 때
- 글로 설명하면 장황해질 때

**제안 방법**:
```
"이 계획은 시각화하면 이해가 쉬울 것 같습니다. ASCII 다이어그램을 포함하시겠습니까?"

예시:
- 플로우차트 (실행 흐름)
- 컴포넌트 다이어그램 (구조)
- 시퀀스 다이어그램 (상호작용)
```

AskUserQuestion으로 시각화 포함 여부 확인.

### Phase 4: Plan Mode 진입

패턴 예시를 참고하여 계획 수립:

```
EnterPlanMode 호출
```

### Phase 5: 계획 문서 작성

Plan Mode 내에서 작성:

```markdown
# 구현 계획: {Feature Name}

## 참고한 패턴
- {pattern 1}: {왜 필요한지}
- {pattern 2}: {왜 필요한지}

## 수정/생성할 파일
| 파일 | 변경 내용 | 참고 패턴 |
|------|----------|----------|
| {path} | {변경 내용} | {pattern} |

## 구현 순서
1. {step 1}
2. {step 2}
3. {step 3}

## 패턴 적용 예시
{brain에서 가져온 예시 기반 설계}

## 검증 방법
- [ ] {검증 항목 1}
- [ ] {검증 항목 2}
```

### Phase 6: devil 계획 최종 검증

계획 완성 후, devil 😈 페르소나로 최종 검증:

**검증 항목**:
- 구현 순서의 논리적 정합성
- 놓친 edge case
- 테스트 가능성
- 롤백 가능성

**출력 형식**:
```markdown
## devil 😈 계획 최종 검증

### 잠재적 문제
- {문제 1}
- {문제 2}

### 개선 제안
- {제안 1}
- {제안 2}
```

검증 후 계획 확정.

---

## 출력 형식

Plan Mode 진입 후, 위 형식의 계획 문서 작성.

---

## 주의사항

1. **요구사항 먼저**: 충분도 판단 없이 바로 계획 X
2. **devil 2회**: 현실성 검증(요구사항 후) + 계획 검증(완성 후)
3. **Brain 먼저**: 패턴 확인 없이 바로 계획 X
4. **예시 기반**: 규칙이 아닌 예시 코드 참고
5. **Progressive Disclosure**: 필요한 패턴만 로드
6. **Plan Mode 필수**: EnterPlanMode로 사용자 승인
7. **시각화 권유**: 복잡한 구조는 ASCII 다이어그램 제안

---

**Last Updated**: 2026-02-05
